<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Helper Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; }
        .test-btn { margin: 5px; padding: 10px 15px; background: #007bff; color: white; border: none; cursor: pointer; }
        .test-element { padding: 10px; margin: 10px 0; background: #f8f9fa; border: 1px solid #dee2e6; }
        .hidden { display: none !important; }
        .fade-test { transition: opacity 0.5s ease; }
        .test-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border: 2px solid #333; z-index: 1000; }
        .test-badge { display: inline-block; background: #dc3545; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; margin-left: 5px; }
        .notification { position: fixed; top: 20px; right: 20px; background: #28a745; color: white; padding: 10px; border-radius: 5px; z-index: 1001; }
        .form-error { color: #dc3545; font-size: 14px; margin-top: 5px; }
    </style>
</head>
<body>
    <h1>DOM Helper Test Page</h1>
    
    <div class="test-section">
        <h3>1. Element Selection & Content</h3>
        <div id="test-element" class="test-element">Original content</div>
        <button class="test-btn" onclick="testElementOperations()">Test Element Operations</button>
    </div>
    
    <div class="test-section">
        <h3>2. Class Management</h3>
        <div id="class-test" class="test-element">Test element for classes</div>
        <button class="test-btn" onclick="testClassOperations()">Test Class Operations</button>
    </div>
    
    <div class="test-section">
        <h3>3. Visibility & Animation</h3>
        <div id="visibility-test" class="test-element fade-test">Visibility test element</div>
        <button class="test-btn" onclick="testVisibilityOperations()">Test Visibility Operations</button>
    </div>
    
    <div class="test-section">
        <h3>4. Modal</h3>
        <div id="test-modal" class="test-modal hidden">
            <h4>Test Modal</h4>
            <p>This is a test modal</p>
            <button onclick="toggleModal('test-modal')">Close Modal</button>
        </div>
        <button class="test-btn" onclick="toggleModal('test-modal')">Toggle Modal</button>
    </div>
    
    <div class="test-section">
        <h3>5. Badge & Notifications</h3>
        <button id="badge-btn" class="test-btn">
            Notifications <span id="test-badge" class="test-badge">0</span>
        </button>
        <button class="test-btn" onclick="testBadgeAndNotification()">Test Badge & Notification</button>
    </div>
    
    <div class="test-section">
        <h3>6. Form Validation</h3>
        <form id="test-form">            <div>
                <label for="email-input">Email:</label>
                <input type="email" id="email-input" name="email" required>
                <div class="form-error" id="email-error"></div>
            </div>
            <div>
                <label for="phone-input">Phone:</label>
                <input type="text" id="phone-input" name="phone" required>
                <div class="form-error" id="phone-error"></div>
            </div>
            <div>
                <label for="name-input">Name (min 3 chars):</label>
                <input type="text" id="name-input" name="name" required>
                <div class="form-error" id="name-error"></div>
            </div>
            <button type="button" class="test-btn" onclick="testFormValidation()">Validate Form</button>
        </form>
    </div>
    
    <div class="test-section">
        <h3>7. Debounce & Throttle</h3>
        <input type="text" id="debounce-input" placeholder="Type here (debounced)">
        <div id="debounce-output">Debounce output: </div>
        <button class="test-btn" id="throttle-btn">Click rapidly (throttled)</button>
        <div id="throttle-output">Throttle count: 0</div>
    </div>
    
    <div id="test-results" class="test-section">
        <h3>Test Results</h3>
        <div id="results-content">Click test buttons to see results...</div>
    </div>

    <script src="dom-helper-clean.js"></script>
    <script>
        let testCount = 0;
        
        function logResult(test, result) {
            testCount++;
            const resultsDiv = getElementById('results-content');
            const resultColor = result ? '#28a745' : '#dc3545';
            const resultText = result ? 'PASS' : 'FAIL';
            const timestamp = new Date().toLocaleTimeString();
            
            const newResult = `<div style="color: ${resultColor}; margin: 5px 0;">
                ${testCount}. [${timestamp}] ${test}: <strong>${resultText}</strong>
            </div>`;
            
            resultsDiv.innerHTML = newResult + resultsDiv.innerHTML;
        }
        
        function testElementOperations() {
            try {
                // Test getElementById
                const element = getElementById('test-element');
                logResult('getElementById', element !== null);
                
                // Test setElementContent
                setElementContent('test-element', 'Content changed by DOM helper!');
                logResult('setElementContent', element.textContent === 'Content changed by DOM helper!');
                
                // Test getElementContent
                const content = getElementContent('test-element');
                logResult('getElementContent', content === 'Content changed by DOM helper!');
                
                setTimeout(() => {
                    setElementContent('test-element', 'Original content');
                }, 2000);
                
            } catch (error) {
                logResult('Element Operations', false);
                console.error('Element operations error:', error);
            }
        }
        
        function testClassOperations() {
            try {
                const element = getElementById('class-test');
                
                // Test addClass
                addClass('class-test', 'test-class-added');
                logResult('addClass', element.classList.contains('test-class-added'));
                
                // Test hasClass
                const hasClassResult = hasClass('class-test', 'test-class-added');
                logResult('hasClass', hasClassResult);
                
                // Test toggleClass
                toggleClass('class-test', 'test-toggle');
                logResult('toggleClass (add)', element.classList.contains('test-toggle'));
                
                toggleClass('class-test', 'test-toggle');
                logResult('toggleClass (remove)', !element.classList.contains('test-toggle'));
                
                // Test removeClass
                removeClass('class-test', 'test-class-added');
                logResult('removeClass', !element.classList.contains('test-class-added'));
                
            } catch (error) {
                logResult('Class Operations', false);
                console.error('Class operations error:', error);
            }
        }
        
        function testVisibilityOperations() {
            try {
                const element = getElementById('visibility-test');
                
                // Test toggleElementVisibility
                toggleElementVisibility('visibility-test');
                const isHidden = element.classList.contains('hidden');
                logResult('toggleElementVisibility (hide)', isHidden);
                
                setTimeout(() => {
                    toggleElementVisibility('visibility-test');
                    logResult('toggleElementVisibility (show)', !element.classList.contains('hidden'));
                }, 1000);
                
                // Test fadeElement
                setTimeout(() => {
                    fadeElement('visibility-test', 'out');
                    logResult('fadeElement out', true);
                }, 2000);
                
                setTimeout(() => {
                    fadeElement('visibility-test', 'in');
                    logResult('fadeElement in', true);
                }, 3000);
                
            } catch (error) {
                logResult('Visibility Operations', false);
                console.error('Visibility operations error:', error);
            }
        }
        
        function testBadgeAndNotification() {
            try {
                // Test updateBadgeCount
                updateBadgeCount('test-badge', 5);
                const badge = getElementById('test-badge');
                logResult('updateBadgeCount', badge.textContent === '5');
                
                // Test showNotificationDOM
                showNotificationDOM('Test notification message!', 'success');
                logResult('showNotificationDOM', true);
                
                setTimeout(() => {
                    updateBadgeCount('test-badge', 0);
                }, 3000);
                
            } catch (error) {
                logResult('Badge & Notification', false);
                console.error('Badge & notification error:', error);
            }
        }
        
        function testFormValidation() {
            try {
                const validationRules = {
                    email: { required: true, email: true },
                    phone: { required: true, phone: true },
                    name: { required: true, minLength: 3 }
                };
                
                const result = validateForm('#test-form', validationRules);
                logResult('validateForm', typeof result === 'object' && typeof result.isValid === 'boolean');
                
                // Clear previous errors
                document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
                
                if (!result.isValid) {
                    result.errors.forEach(error => {
                        console.log('Validation error:', error);
                    });
                    
                    const resultsDiv = getElementById('results-content');
                    resultsDiv.innerHTML = `<div style="color: #dc3545;">Validation errors: ${result.errors.join(', ')}</div>` + resultsDiv.innerHTML;
                } else {
                    const resultsDiv = getElementById('results-content');
                    resultsDiv.innerHTML = `<div style="color: #28a745;">Form validation passed!</div>` + resultsDiv.innerHTML;
                }
                
            } catch (error) {
                logResult('Form Validation', false);
                console.error('Form validation error:', error);
            }
        }
        
        // Setup debounce test
        let throttleCount = 0;
        
        if (typeof debounce === 'function') {
            const debouncedFunction = debounce((value) => {
                getElementById('debounce-output').textContent = `Debounce output: ${value}`;
            }, 500);
            
            getElementById('debounce-input').addEventListener('input', (e) => {
                debouncedFunction(e.target.value);
            });
            
            logResult('Debounce setup', true);
        } else {
            logResult('Debounce setup', false);
        }
        
        // Setup throttle test
        if (typeof throttle === 'function') {
            const throttledFunction = throttle(() => {
                throttleCount++;
                getElementById('throttle-output').textContent = `Throttle count: ${throttleCount}`;
            }, 1000);
            
            getElementById('throttle-btn').addEventListener('click', throttledFunction);
            
            logResult('Throttle setup', true);
        } else {
            logResult('Throttle setup', false);
        }
        
        // Initial test
        setTimeout(() => {
            logResult('DOM Helper loaded', typeof getElementById === 'function');
        }, 100);
    </script>
</body>
</html>
